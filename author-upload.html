<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Author Dashboard - Upload Your Book</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Additional styles for upload page */
        .upload-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        textarea {
            height: 120px;
            resize: vertical;
        }
        
        .file-upload {
            border: 2px dashed #3498db;
            padding: 40px;
            text-align: center;
            border-radius: 10px;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            background: #e8f4fc;
            border-color: #2980b9;
        }
        
        .file-upload input {
            display: none;
        }
        
        .file-label {
            font-size: 1.2rem;
            color: #3498db;
        }
        
        .commission-note {
            background: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }
        
        .btn-submit {
            background: #3498db;
            color: white;
            padding: 15px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
            margin-top: 20px;
        }
        
        .btn-submit:hover {
            background: #2980b9;
        }
        
        .btn-submit:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #3498db;
            text-decoration: none;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
        
        /* Step Indicators */
        .step-indicators {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .step-indicator {
            text-align: center;
            position: relative;
        }
        
        .step-indicator.active .step-number {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .step-indicator.active .step-text {
            color: #3498db;
            font-weight: bold;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: #ecf0f1;
            color: #7f8c8d;
            border: 2px solid #bdc3c7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .step-text {
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        /* Step Navigation Buttons */
        .step-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn-step {
            padding: 12px 30px;
            font-size: 1.1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-prev {
            background: #95a5a6;
            color: white;
        }
        
        .btn-prev:hover {
            background: #7f8c8d;
        }
        
        .btn-next {
            background: #3498db;
            color: white;
        }
        
        .btn-next:hover {
            background: #2980b9;
        }
        
        /* Form Steps */
        .form-step {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* File Preview */
        .file-preview {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #ecf0f1;
        }
        
        .preview-image {
            max-width: 200px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <header>
        <h1>üìö BookStore - Author Dashboard</h1>
        <p>Upload your book and start earning 70% royalties</p>
    </header>
    
    <main>
        <div class="upload-container">
            <h2>Upload Your Book</h2>
            
            <div class="commission-note">
                <strong>Royalty Information:</strong> You earn 70% of each sale. We handle payment processing, hosting, and marketing.
            </div>
            
            <!-- Step Indicators -->
            <div class="step-indicators">
                <div class="step-indicator active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-text">Book Details</div>
                </div>
                <div class="step-indicator" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-text">Upload Files</div>
                </div>
            </div>
            
            <form id="bookUploadForm">
                <!-- Step 1: Book Details -->
                <div class="form-step" data-step="1" style="display: block;">
                    <!-- Book Title -->
                    <div class="form-group">
                        <label for="bookTitle">Book Title *</label>
                        <input type="text" id="bookTitle" placeholder="Enter your book title" required>
                    </div>
                    
                    <!-- Author Name -->
                    <div class="form-group">
                        <label for="authorName">Author Name *</label>
                        <input type="text" id="authorName" placeholder="Your name or pen name" required>
                    </div>
                    
                    <!-- Description -->
                    <div class="form-group">
                        <label for="description">Book Description *</label>
                        <textarea id="description" placeholder="Describe your book (2-3 paragraphs recommended)" required></textarea>
                    </div>
                    
                    <!-- Price -->
                    <div class="form-group">
                        <label for="price">Price (USD) *</label>
                        <input type="number" id="price" min="0.99" max="99.99" step="0.01" placeholder="9.99" required>
                        <small>Recommended: $2.99 - $14.99</small>
                    </div>
                    
                    <!-- Category -->
                    <div class="form-group">
                        <label for="category">Category *</label>
                        <select id="category" required>
                            <option value="">Select a category</option>
                            <option value="fiction">Fiction</option>
                            <option value="non-fiction">Non-Fiction</option>
                            <option value="romance">Romance</option>
                            <option value="mystery">Mystery</option>
                            <option value="science-fiction">Science Fiction</option>
                            <option value="fantasy">Fantasy</option>
                            <option value="biography">Biography</option>
                            <option value="self-help">Self-Help</option>
                            <option value="children">Children's Books</option>
                        </select>
                    </div>
                    
                    <!-- Earnings Calculator -->
                    <div class="commission-note" style="margin-top: 20px;">
                        <h4>üí∞ Royalty Calculator</h4>
                        <p>If you sell your book at $<span id="priceDisplay">0</span>:</p>
                        <ul>
                            <li>You earn: $<span id="authorEarn">0</span> (70%)</li>
                            <li>Platform fee: $<span id="platformFee">0</span> (30%)</li>
                            <li>Payment processing fee: ~$<span id="processingFee">0</span></li>
                            <li><strong>Your net: $<span id="netEarn">0</span></strong></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Step 2: File Upload -->
                <div class="form-step" data-step="2" style="display: none;">
                    <!-- Book Cover -->
                    <div class="form-group">
                        <label for="coverImage">Book Cover Image *</label>
                        <div class="file-upload" id="coverUploadArea">
                            <div class="file-label">
                                üì∑ Click to upload cover image
                            </div>
                            <p>JPEG or PNG, minimum 800x1200 pixels</p>
                            <input type="file" id="coverImage" accept="image/*" required>
                        </div>
                        <div class="file-preview" id="coverPreview">
                            No cover image selected
                        </div>
                    </div>
                    
                    <!-- Book File -->
                    <div class="form-group">
                        <label for="bookFile">Book File (PDF/EPUB) *</label>
                        <div class="file-upload" id="bookUploadArea">
                            <div class="file-label">
                                üìÑ Click to upload book file
                            </div>
                            <p>PDF or EPUB format, max file size: 50MB</p>
                            <input type="file" id="bookFile" accept=".pdf,.epub" required>
                        </div>
                        <div class="file-preview" id="fileInfo">
                            No book file selected
                        </div>
                    </div>
                    
                    <!-- Sample File (Optional) -->
                    <div class="form-group">
                        <label for="sampleFile">Sample Chapter (Optional)</label>
                        <div class="file-upload" id="sampleUploadArea">
                            <div class="file-label">
                                üìñ Click to upload sample
                            </div>
                            <p>First 3 chapters or 10% of book</p>
                            <input type="file" id="sampleFile" accept=".pdf,.epub">
                        </div>
                        <div class="file-preview" id="sampleInfo">
                            No sample file selected
                        </div>
                    </div>
                </div>
                
                <!-- Step Navigation Buttons -->
                <div class="step-buttons">
                    <button type="button" id="prevStepBtn" class="btn-step btn-prev" style="display: none;">
                        ‚Üê Previous Step
                    </button>
                    <button type="button" id="nextStepBtn" class="btn-step btn-next">
                        Next: Upload File ‚Üí
                    </button>
                </div>
            </form>
            
            <a href="index.html" class="back-link">‚Üê Back to Homepage</a>
        </div>
    </main>
    
    <footer>
        <p>¬© 2023 BookStore. All rights reserved.</p>
    </footer>
    
    <script src="author-script.js"></script>
    <script>
        // Step Navigation Logic
        document.addEventListener('DOMContentLoaded', function() {
            let currentStep = 1;
            const totalSteps = 2;
            
            // Get elements
            const nextStepBtn = document.getElementById('nextStepBtn');
            const prevStepBtn = document.getElementById('prevStepBtn');
            const form = document.getElementById('bookUploadForm');
            
            // Function to show a specific step
            function showStep(step) {
                // Hide all steps
                document.querySelectorAll('.form-step').forEach(stepEl => {
                    stepEl.style.display = 'none';
                });
                
                // Show the requested step
                const stepToShow = document.querySelector(`.form-step[data-step="${step}"]`);
                if (stepToShow) {
                    stepToShow.style.display = 'block';
                }
                
                // Update step indicators
                document.querySelectorAll('.step-indicator').forEach(indicator => {
                    indicator.classList.remove('active');
                });
                document.querySelector(`.step-indicator[data-step="${step}"]`).classList.add('active');
                
                // Update button text and visibility
                if (step === 1) {
                    prevStepBtn.style.display = 'none';
                    nextStepBtn.textContent = 'Next: Upload File ‚Üí';
                    nextStepBtn.style.display = 'block';
                } else if (step === 2) {
                    prevStepBtn.style.display = 'block';
                    nextStepBtn.textContent = 'Publish Book';
                    nextStepBtn.style.display = 'block';
                }
                
                currentStep = step;
            }
            
            // Next step button click
            nextStepBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                if (currentStep === 1) {
                    // Validate step 1 before proceeding
                    const title = document.getElementById('bookTitle').value.trim();
                    const author = document.getElementById('authorName').value.trim();
                    const price = document.getElementById('price').value.trim();
                    const description = document.getElementById('description').value.trim();
                    const category = document.getElementById('category').value;
                    
                    let error = '';
                    if (!title) error += '‚Ä¢ Book title is required\n';
                    if (!author) error += '‚Ä¢ Author name is required\n';
                    if (!price || parseFloat(price) < 0.99) error += '‚Ä¢ Valid price is required (min $0.99)\n';
                    if (!description) error += '‚Ä¢ Description is required\n';
                    if (!category) error += '‚Ä¢ Category is required\n';
                    
                    if (error) {
                        alert('Please fix the following errors:\n\n' + error);
                        return;
                    }
                    
                    // Move to step 2
                    showStep(2);
                    
                } else if (currentStep === 2) {
                    // Validate step 2 (file uploads) before submitting
                    const coverFile = document.getElementById('coverImage').files[0];
                    const bookFile = document.getElementById('bookFile').files[0];
                    
                    let error = '';
                    if (!coverFile) error += '‚Ä¢ Cover image is required\n';
                    if (!bookFile) error += '‚Ä¢ Book file is required\n';
                    
                    if (error) {
                        alert('Please fix the following errors:\n\n' + error);
                        return;
                    }
                    
                    // Validate file types
                    if (coverFile && !coverFile.type.startsWith('image/')) {
                        alert('Cover must be an image file (JPEG, PNG, etc.)');
                        return;
                    }
                    
                    if (bookFile) {
                        const validTypes = ['application/pdf', 'application/epub+zip'];
                        const validExt = bookFile.name.toLowerCase().endsWith('.pdf') || 
                                        bookFile.name.toLowerCase().endsWith('.epub');
                        
                        if (!validTypes.includes(bookFile.type) && !validExt) {
                            alert('Book file must be PDF or EPUB format');
                            return;
                        }
                        
                        if (bookFile.size > 50 * 1024 * 1024) {
                            alert('Book file must be less than 50MB');
                            return;
                        }
                    }
                    
                    // Change button to show uploading
                    nextStepBtn.textContent = 'Uploading...';
                    nextStepBtn.disabled = true;
                    
                    // Trigger the form submission (handled by author-script.js)
                    form.dispatchEvent(new Event('submit'));
                }
            });
            
            // Previous step button click
            prevStepBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showStep(1);
            });
            
            // File upload click handlers
            document.getElementById('coverUploadArea').addEventListener('click', function() {
                document.getElementById('coverImage').click();
            });
            
            document.getElementById('bookUploadArea').addEventListener('click', function() {
                document.getElementById('bookFile').click();
            });
            
            document.getElementById('sampleUploadArea').addEventListener('click', function() {
                document.getElementById('sampleFile').click();
            });
            
            // File change handlers
            document.getElementById('coverImage').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const preview = document.getElementById('coverPreview');
                
                if (file && file.type.startsWith('image/')) {
                    if (file.size > 5 * 1024 * 1024) {
                        alert('Cover image must be less than 5MB');
                        this.value = '';
                        preview.innerHTML = 'No cover image selected';
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `
                            <img src="${e.target.result}" class="preview-image">
                            <div>${file.name} (${(file.size/1024/1024).toFixed(2)} MB)</div>
                        `;
                    };
                    reader.readAsDataURL(file);
                } else if (file) {
                    alert('Please select an image file (JPEG, PNG, etc.)');
                    this.value = '';
                    preview.innerHTML = 'No cover image selected';
                }
            });
            
            document.getElementById('bookFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const preview = document.getElementById('fileInfo');
                
                if (file) {
                    const validTypes = ['application/pdf', 'application/epub+zip'];
                    const validExt = file.name.toLowerCase().endsWith('.pdf') || 
                                    file.name.toLowerCase().endsWith('.epub');
                    
                    if ((!validTypes.includes(file.type) && !validExt) || file.size > 50 * 1024 * 1024) {
                        alert('Book file must be PDF or EPUB format and less than 50MB');
                        this.value = '';
                        preview.innerHTML = 'No book file selected';
                        return;
                    }
                    
                    preview.innerHTML = `
                        <div style="color: #2ecc71;">
                            ‚úÖ ${file.name}<br>
                            Size: ${(file.size/1024/1024).toFixed(2)} MB
                        </div>
                    `;
                }
            });
            
            document.getElementById('sampleFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const preview = document.getElementById('sampleInfo');
                
                if (file) {
                    const validTypes = ['application/pdf', 'application/epub+zip'];
                    const validExt = file.name.toLowerCase().endsWith('.pdf') || 
                                    file.name.toLowerCase().endsWith('.epub');
                    
                    if ((!validTypes.includes(file.type) && !validExt) || file.size > 50 * 1024 * 1024) {
                        alert('Sample file must be PDF or EPUB format and less than 50MB');
                        this.value = '';
                        preview.innerHTML = 'No sample file selected';
                        return;
                    }
                    
                    preview.innerHTML = `
                        <div style="color: #3498db;">
                            üìñ ${file.name}<br>
                            Size: ${(file.size/1024/1024).toFixed(2)} MB
                        </div>
                    `;
                }
            });
            
            // Royalty Calculator
            const priceInput = document.getElementById('price');
            const priceDisplay = document.getElementById('priceDisplay');
            const authorEarn = document.getElementById('authorEarn');
            const platformFee = document.getElementById('platformFee');
            const processingFee = document.getElementById('processingFee');
            const netEarn = document.getElementById('netEarn');
            
            function updateRoyaltyCalculator() {
                const price = parseFloat(priceInput.value) || 0;
                
                // Update display
                priceDisplay.textContent = price.toFixed(2);
                
                // Calculate
                const authorShare = price * 0.70; // 70%
                const platformShare = price * 0.30; // 30%
                const paymentFee = (price * 0.029) + 0.30; // Stripe-like fee (2.9% + $0.30)
                const netAuthorEarn = authorShare - paymentFee;
                
                // Update display
                authorEarn.textContent = authorShare.toFixed(2);
                platformFee.textContent = platformShare.toFixed(2);
                processingFee.textContent = paymentFee.toFixed(2);
                netEarn.textContent = netAuthorEarn.toFixed(2);
                
                // Color code
                if (netAuthorEarn > 0) {
                    netEarn.style.color = '#2ecc71';
                } else {
                    netEarn.style.color = '#e74c3c';
                }
            }
            
            priceInput.addEventListener('input', updateRoyaltyCalculator);
            updateRoyaltyCalculator();
        });
    </script>
</body>
</html>
